import{_ as M,E as J,W as Y,o as U,H as G,D as H,r as y,I as q,c as h,f as g,a as e,b as s,m as k,y as S,n as P,z as D,t as L,h as Q,a3 as X,d as N,s as R,j as B,F as V,i as K,C as ee,a4 as te,e as O,K as F,L as se,u as T,g as I,p as ne,q as oe,w as z,k as j,T as Z,J as le,v as ie}from"./index-DjdTX2jE.js";import{L as n}from"./localeText-BJtl_6DQ.js";import{d as ae}from"./dayjs.min-B_xAIm8i.js";const de={class:"card rounded-3 flex-grow-1 bg-danger-subtle border-danger-subtle border shadow"},re={class:"card-body"},ue={class:"d-flex align-items-center gap-3 inputGroup"},ce=["value"],me={class:"mb-0"},fe={class:"d-flex mt-3"},ge=["disabled"],be={__name:"updateConfigurationName",props:{configurationName:String},emits:["close"],setup(d,{emit:r}){const t=d,f=r,o=J({data:"",valid:!1}),b=Y();U(()=>{G(()=>o.data,x=>{o.valid=/^[a-zA-Z0-9_=+.-]{1,15}$/.test(x)&&x.length>0&&!b.Configurations.find(_=>_.Name===x)})});const u=H(),p=y(!1),l=q(),m=async()=>{o.data&&(p.value=!0,clearInterval(u.Peers.RefreshInterval),await D("/api/renameWireguardConfiguration",{ConfigurationName:t.configurationName,NewConfigurationName:o.data},async x=>{x.status?(await b.getConfigurations(),u.newMessage("Server","Configuration renamed","success"),l.push(`/configuration/${o.data}/peers`)):(u.newMessage("Server",x.message,"danger"),p.value=!1)}))};return(x,_)=>(g(),h("div",de,[e("div",re,[e("p",null,[s(n,{t:"To update this configuration's name, WGDashboard will execute the following operations:"})]),e("ol",null,[e("li",null,[s(n,{t:"Duplicate current configuration's database table and .conf file with the new name"})]),e("li",null,[s(n,{t:"Delete current configuration's database table and .conf file"})])]),e("div",ue,[e("input",{class:"form-control form-control-sm rounded-3",value:d.configurationName,disabled:""},null,8,ce),_[3]||(_[3]=e("h3",{class:"mb-0"},[e("i",{class:"bi bi-arrow-right"})],-1)),k(e("input",{class:P(["form-control form-control-sm rounded-3",[o.data?o.valid?"is-valid":"is-invalid":""]]),id:"newConfigurationName","onUpdate:modelValue":_[0]||(_[0]=w=>o.data=w)},null,2),[[S,o.data]])]),e("div",{class:P(["invalid-feedback",{"d-block":!o.valid&&o.data}])},[s(n,{t:"Configuration name is invalid. Possible reasons:"}),e("ul",me,[e("li",null,[s(n,{t:"Configuration name already exist"})]),e("li",null,[s(n,{t:"Configuration name can only contain 15 lower/uppercase alphabet, numbers, underscore, equal sign, plus sign, period and hyphen."})])])],2),e("div",fe,[e("button",{onClick:_[1]||(_[1]=w=>f("close")),class:"btn btn-sm bg-secondary-subtle border-secondary-subtle text-secondary-emphasis rounded-3"},[s(n,{t:"Cancel"})]),e("button",{onClick:_[2]||(_[2]=w=>m()),disabled:!o.data||p.value,class:"btn btn-sm btn-danger rounded-3 ms-auto"},[s(n,{t:"Save"})],8,ge)])])]))}},ve=M(be,[["__scopeId","data-v-33ea9576"]]),pe={name:"Dropdown",props:{width:{type:String,default:"80px"},height:{type:String,default:"auto"},title:{type:String,default:""},disabled:{type:Boolean,default:!1},defaultDisplay:{type:Boolean,default:!1}}},he={class:"title"};function ye(d,r,t,f,o,b){return g(),h("div",{class:P(["dropdown",{disabled:t.disabled}]),onClick:r[0]||(r[0]=(...u)=>d.toggleDropdown&&d.toggleDropdown(...u)),onFocusout:r[1]||(r[1]=(...u)=>d.hideDropdown&&d.hideDropdown(...u)),tabindex:"0"},[e("div",he,[e("div",null,L(t.title),1)])],34)}const xe=M(pe,[["render",ye]]),_e={components:{Dropdown:xe},name:"CodeEditor",props:{lineNums:{type:Boolean,default:!1},modelValue:{type:String},value:{type:String},theme:{type:String,default:"github-dark"},tabSpaces:{type:Number,default:2},wrap:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},header:{type:Boolean,default:!0},width:{type:String,default:"540px"},height:{type:String,default:"auto"},maxWidth:{type:String},minWidth:{type:String},maxHeight:{type:String},minHeight:{type:String},borderRadius:{type:String,default:"12px"},languages:{type:Array,default:function(){return[["javascript","JS"]]}},langListWidth:{type:String,default:"110px"},langListHeight:{type:String,default:"auto"},langListDisplay:{type:Boolean,default:!1},displayLanguage:{type:Boolean,default:!0},zIndex:{type:String,default:"0"},fontSize:{type:String,default:"17px"},padding:{type:String,default:"20px"}},directives:{highlight:{mounted(d,r){d.textContent=r.value},updated(d,r){d.scrolling?d.scrolling=!1:d.textContent=r.value}}},data(){return{scrollBarWidth:0,scrollBarHeight:0,top:0,left:0,languageClass:"hljs language-"+this.languages[0][0],languageTitle:this.languages[0][1]?this.languages[0][1]:this.languages[0][0],content:this.value,cursorPosition:0,insertTab:!1,lineNum:0,lineNumsWidth:0,scrolling:!1,textareaHeight:0,showLineNums:this.wrap?!1:this.lineNums}},computed:{tabWidth(){let d="";for(let r=0;r<this.tabSpaces;r++)d+=" ";return d},contentValue(){return this.modelValue==null?this.content+`
`:this.modelValue+`
`},scroll(){return this.height!="auto"}},methods:{updateValue(d){this.modelValue==null?this.content=d.target.value:this.$emit("update:modelValue",d.target.value)},changeLang(d){this.languageTitle=d[1]?d[1]:d[0],this.languageClass="language-"+d[0],this.$emit("lang",d[0])},tab(){if(document.execCommand("insertText"))document.execCommand("insertText",!1,this.tabWidth);else{const d=this.$refs.textarea.selectionStart;this.content=this.content.substring(0,d)+this.tabWidth+this.content.substring(d),this.cursorPosition=d+this.tabWidth.length,this.insertTab=!0}},calcScrollDistance(d){this.$refs.code.scrolling=!0,this.scrolling=!0,this.top=-d.target.scrollTop,this.left=-d.target.scrollLeft},resizer(){new ResizeObserver(t=>{this.scrollBarWidth=t[0].target.offsetWidth-t[0].target.clientWidth,this.scrollBarHeight=t[0].target.offsetHeight-t[0].target.clientHeight,this.textareaHeight=t[0].target.offsetHeight}).observe(this.$refs.textarea);const r=new ResizeObserver(t=>{this.lineNumsWidth=t[0].target.offsetWidth});this.$refs.lineNums&&r.observe(this.$refs.lineNums)},copy(){document.execCommand("copy")?(this.$refs.textarea.select(),document.execCommand("copy"),window.getSelection().removeAllRanges()):navigator.clipboard.writeText(this.$refs.textarea.value)},getLineNum(){const d=this.$refs.textarea.value;let r=0,t=d.indexOf(`
`);for(;t!==-1;)r++,t=d.indexOf(`
`,t+1);const f=this.$refs.lineNums.firstChild.offsetHeight,o=parseInt(this.textareaHeight/f)-1;this.lineNum=this.height=="auto"||r>o?r:o}},mounted(){this.$emit("lang",this.languages[0][0]),this.$emit("content",this.content),this.$emit("textarea",this.$refs.textarea),this.resizer()},updated(){this.insertTab&&(this.$refs.textarea.setSelectionRange(this.cursorPosition,this.cursorPosition),this.insertTab=!1),this.lineNums&&(this.scrolling?this.scrolling=!1:this.getLineNum())}},we=["theme"],Ce=["readOnly","autofocus","value"];function ke(d,r,t,f,o,b){const u=Q("Dropdown"),p=X("highlight");return g(),h("div",{theme:t.theme,class:P(["code-editor",{"hide-header":!t.header,scroll:b.scroll,"read-only":t.readOnly,wrap:t.wrap}]),style:R({width:t.width,height:t.height,zIndex:t.zIndex,maxWidth:t.maxWidth,minWidth:t.minWidth,maxHeight:t.maxHeight,minHeight:t.minHeight})},[e("div",{class:"hljs",style:R({borderRadius:t.borderRadius})},[t.header?(g(),h("div",{key:0,class:P(["header",{border:o.showLineNums}]),style:R({borderRadius:t.borderRadius+" "+t.borderRadius+" 0 0"})},[t.displayLanguage?(g(),B(u,{key:0,width:t.langListWidth,title:o.languageTitle,disabled:t.languages.length<=1,defaultDisplay:t.langListDisplay},null,8,["width","title","disabled","defaultDisplay"])):N("",!0)],6)):N("",!0),e("div",{class:"code-area",style:R({borderRadius:t.header?"0 0 "+t.borderRadius+" "+t.borderRadius:t.borderRadius})},[o.showLineNums?(g(),h("div",{key:0,ref:"lineNums",class:"line-nums hljs",style:R({fontSize:t.fontSize,paddingTop:t.header?"10px":t.padding,paddingBottom:t.padding,top:o.top+"px"})},[r[3]||(r[3]=e("div",null,"1",-1)),(g(!0),h(V,null,K(o.lineNum,l=>(g(),h("div",null,L(l+1),1))),256)),r[4]||(r[4]=e("div",null,"Â ",-1))],4)):N("",!0),e("textarea",{title:"textarea",readOnly:t.readOnly,style:R({fontSize:t.fontSize,padding:t.header?t.lineNums?"10px "+t.padding+" "+t.padding:"0 "+t.padding+" "+t.padding:t.padding,marginLeft:o.showLineNums?o.lineNumsWidth+"px":"0",width:o.showLineNums?"calc(100% - "+o.lineNumsWidth+"px)":"100%"}),ref:"textarea",autofocus:t.autofocus,spellcheck:"false",onKeydown:r[0]||(r[0]=ee(te((...l)=>b.tab&&b.tab(...l),["prevent","stop"]),["tab"])),onScroll:r[1]||(r[1]=(...l)=>b.calcScrollDistance&&b.calcScrollDistance(...l)),value:t.modelValue==null?o.content:t.modelValue,onInput:r[2]||(r[2]=(...l)=>b.updateValue&&b.updateValue(...l))},null,44,Ce),e("pre",{style:R({paddingRight:o.scrollBarWidth+"px",paddingBottom:o.scrollBarHeight+"px",marginLeft:o.showLineNums?o.lineNumsWidth+"px":"0",width:o.showLineNums?"calc(100% - "+o.lineNumsWidth+"px)":"100%"})},[r[6]||(r[6]=O("        ")),k((g(),h("code",{ref:"code",class:P(o.languageClass),style:R({top:o.top+"px",left:o.left+"px",fontSize:t.fontSize,padding:t.header?t.lineNums?"10px "+t.padding+" "+t.padding:"0 "+t.padding+" "+t.padding:t.padding})},r[5]||(r[5]=[O(`
        `)]),6)),[[p,b.contentValue]]),r[7]||(r[7]=O(`
      `))],4)],4)],4)],14,we)}const $e=M(_e,[["render",ke]]),Se={class:"peerSettingContainer w-100 h-100 position-absolute top-0 start-0 overflow-y-scroll"},Ne={class:"container d-flex h-100 w-100"},Pe={class:"m-auto modal-dialog-centered dashboardModal",style:{width:"1000px"}},Be={class:"card rounded-3 shadow flex-grow-1",id:"deleteConfigurationContainer"},Re={class:"card-header bg-transparent d-flex align-items-center gap-2 border-0 p-4 pb-0"},De={class:"mb-0"},Le={class:"card-body px-4 d-flex flex-column gap-3"},We={key:0,class:"alert alert-danger rounded-3 mb-0"},Ve={class:"mb-2"},Oe={class:"bg-body w-100 p-2 rounded-3"},Ie={class:"d-flex gap-2"},Me=["disabled"],He=["disabled"],Ke={__name:"editRawConfigurationFile",emits:["close"],async setup(d,{emit:r}){let t,f;const o=r,b=F(),u=y(""),p=y(""),l=y(!1),m=y(""),x=async()=>{await I("/api/getWireguardConfigurationRawFile",{configurationName:b.params.id},c=>{u.value=c.data.content,p.value=c.data.path})};[t,f]=se(()=>x()),await t,f();const _=H(),w=y(!1),$=async()=>{w.value=!0,await D("/api/updateWireguardConfigurationRawFile",{configurationName:b.params.id,rawConfiguration:u.value},c=>{c.status?(l.value=!1,_.newMessage("Server","Configuration saved","success")):(l.value=!0,m.value=c.message),w.value=!1})};return(c,a)=>(g(),h("div",Se,[e("div",Ne,[e("div",Pe,[e("div",Be,[e("div",Re,[e("h5",De,[s(n,{t:"Edit Raw Configuration File"})]),e("button",{type:"button",class:"btn-close ms-auto",onClick:a[0]||(a[0]=C=>o("close"))})]),e("div",Le,[l.value?(g(),h("div",We,[e("div",Ve,[e("strong",null,[s(n,{t:"Failed to save configuration. Please see the following error message:"})])]),e("div",Oe,[e("pre",null,L(m.value),1)])])):N("",!0),s($e,{disabled:!0,"read-only":w.value,modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=C=>u.value=C),theme:T(_).Configuration.Server.dashboard_theme==="dark"?"github-dark":"github",languages:[["ini",p.value]],width:"100%",height:"600px"},null,8,["read-only","modelValue","theme","languages"]),e("div",Ie,[e("button",{class:"btn bg-secondary-subtle border-secondary-subtle text-secondary-emphasis rounded-3 shadow ms-auto px-3 py-2",disabled:w.value,onClick:a[2]||(a[2]=C=>x())},[a[4]||(a[4]=e("i",{class:"bi bi-arrow-clockwise me-2"},null,-1)),s(n,{t:"Reset"})],8,Me),e("button",{onClick:a[3]||(a[3]=C=>$()),disabled:w.value,class:"btn bg-danger-subtle border-danger-subtle text-danger-emphasis rounded-3 px-3 py-2 shadow"},[a[5]||(a[5]=e("i",{class:"bi bi-save-fill me-2"},null,-1)),w.value?(g(),B(n,{key:1,t:"Saving..."})):(g(),B(n,{key:0,t:"Save"}))],8,He)])])])])])]))}},Te={class:"peerSettingContainer w-100 h-100 position-absolute top-0 start-0 overflow-y-scroll"},ze={class:"container d-flex h-100 w-100"},Ue={class:"m-auto modal-dialog-centered dashboardModal",style:{width:"700px"}},Fe={class:"card rounded-3 shadow flex-grow-1 bg-danger-subtle border-danger-subtle",id:"deleteConfigurationContainer"},Ae={class:"card-header bg-transparent d-flex align-items-center gap-2 border-0 p-4 pb-0"},Ee={class:"mb-0"},Je={class:"card-body px-4 text-muted"},je={class:"mb-0"},Ye={key:0},Ge={key:1},qe={key:2,class:"d-flex align-items-center gap-2"},Ze=["placeholder"],Qe=["disabled"],Xe={__name:"deleteConfiguration",emits:["backup","close"],setup(d,{emit:r}){const f=F().params.id,o=y(""),b=q(),u=H(),p=y(!1),l=()=>{clearInterval(u.Peers.RefreshInterval),p.value=!0,D("/api/deleteWireguardConfiguration",{ConfigurationName:f},$=>{$.status?(b.push("/"),u.newMessage("Server","Configuration deleted","success")):p.value=!1})},m=y(!0),x=y([]),_=()=>{m.value=!0,I("/api/getWireguardConfigurationBackup",{configurationName:f},$=>{x.value=$.data,m.value=!1})};U(()=>{_()});const w=r;return($,c)=>(g(),h("div",Te,[e("div",ze,[e("div",Ue,[e("div",Fe,[e("div",Ae,[e("h5",Ee,[s(n,{t:"Are you sure to delete this configuration?"})]),e("button",{type:"button",class:"btn-close ms-auto",onClick:c[0]||(c[0]=a=>w("close"))})]),e("div",Je,[e("p",je,[s(n,{t:"Once you deleted this configuration:"})]),e("ul",null,[e("li",null,[s(n,{t:"All connected peers will get disconnected"})]),e("li",null,[s(n,{t:"Both configuration file (.conf) and database table related to this configuration will get deleted"})])]),e("div",{class:P(["alert",[m.value?"alert-secondary":x.value.length>0?"alert-success":"alert-danger"]])},[m.value?(g(),h("div",Ye,[c[5]||(c[5]=e("i",{class:"bi bi-search me-2"},null,-1)),s(n,{t:"Checking backups..."})])):x.value.length>0?(g(),h("div",Ge,[c[6]||(c[6]=e("i",{class:"bi bi-check-circle-fill me-2"},null,-1)),s(n,{t:"This configuration have "+x.value.length+" backups"},null,8,["t"])])):(g(),h("div",qe,[c[9]||(c[9]=e("i",{class:"bi bi-x-circle-fill me-2"},null,-1)),s(n,{t:"This configuration have no backup"}),e("a",{role:"button",onClick:c[1]||(c[1]=a=>w("backup")),class:"ms-auto btn btn-sm btn-primary rounded-3"},[c[7]||(c[7]=e("i",{class:"bi bi-clock-history me-2"},null,-1)),s(n,{t:"Backup"})]),e("a",{role:"button",onClick:c[2]||(c[2]=a=>_()),class:"btn btn-sm btn-primary rounded-3"},c[8]||(c[8]=[e("i",{class:"bi bi-arrow-clockwise"},null,-1)]))]))],2),c[11]||(c[11]=e("hr",null,null,-1)),e("p",null,[s(n,{t:"If you're sure, please type in the configuration name below and click Delete"})]),k(e("input",{class:"form-control rounded-3 mb-3",placeholder:T(f),"onUpdate:modelValue":c[3]||(c[3]=a=>o.value=a),type:"text"},null,8,Ze),[[S,o.value]]),e("button",{class:"btn btn-danger w-100",onClick:c[4]||(c[4]=a=>l()),disabled:o.value!==T(f)||p.value},[c[10]||(c[10]=e("i",{class:"bi bi-trash-fill me-2 rounded-3"},null,-1)),p.value?(g(),B(n,{key:1,t:"Deleting..."})):(g(),B(n,{key:0,t:"Delete"}))],8,Qe)])])])])]))}},et={class:"card my-0 rounded-3"},tt={class:"card-body position-relative"},st={key:0,class:"position-absolute w-100 h-100 confirmationContainer start-0 top-0 rounded-3 d-flex p-2"},nt={class:"m-auto"},ot={class:"d-flex gap-2 align-items-center justify-content-center"},lt=["disabled"],it=["disabled"],at={key:0,class:"position-absolute w-100 h-100 confirmationContainer start-0 top-0 rounded-3 d-flex p-2"},dt={class:"m-auto"},rt={class:"d-flex gap-2 align-items-center justify-content-center"},ut=["disabled"],ct=["disabled"],mt={class:"d-flex gap-3"},ft={class:"d-flex flex-column"},gt={class:"text-muted"},bt={class:"d-flex flex-column"},vt={class:"text-muted"},pt={class:"d-flex gap-2 align-items-center ms-auto"},ht={class:"card rounded-3"},yt={key:0,class:"card-body"},xt=["value"],_t={class:"d-flex"},wt={__name:"backup",props:["b","delay"],emits:["refresh","refreshPeersList"],setup(d,{emit:r}){ne(c=>({b32c1fd8:w.value}));const t=d,f=y(!1),o=y(!1),b=F(),u=r,p=H(),l=y(!1),m=()=>{l.value=!0,D("/api/deleteWireguardConfigurationBackup",{ConfigurationName:b.params.id,BackupFileName:t.b.filename},c=>{l.value=!1,c.status?(u("refresh"),p.newMessage("Server","Backup deleted","success")):p.newMessage("Server","Backup failed to delete","danger")})},x=()=>{l.value=!0,D("/api/restoreWireguardConfigurationBackup",{ConfigurationName:b.params.id,BackupFileName:t.b.filename},c=>{l.value=!1,o.value=!1,c.status?(u("refreshPeersList"),p.newMessage("Server","Backup restored with "+t.b.filename,"success")):p.newMessage("Server","Backup failed to restore","danger")})},_=()=>{I("/api/downloadWireguardConfigurationBackup",{configurationName:b.params.id,backupFileName:t.b.filename},c=>{c.status&&window.open(`/fileDownload?file=${c.data}`,"_blank")})},w=oe(()=>t.delay+"s"),$=y(!1);return(c,a)=>(g(),h("div",et,[e("div",tt,[s(j,{name:"zoomReversed"},{default:z(()=>[f.value?(g(),h("div",st,[e("div",nt,[e("h5",null,[s(n,{t:"Are you sure to delete this backup?"})]),e("div",ot,[e("button",{class:"btn btn-danger rounded-3",disabled:l.value,onClick:a[0]||(a[0]=C=>m())},[s(n,{t:"Yes"})],8,lt),e("button",{onClick:a[1]||(a[1]=C=>f.value=!1),disabled:l.value,class:"btn bg-secondary-subtle text-secondary-emphasis border-secondary-subtle rounded-3"},[s(n,{t:"No"})],8,it)])])])):N("",!0)]),_:1}),s(j,{name:"zoomReversed"},{default:z(()=>[o.value?(g(),h("div",at,[e("div",dt,[e("h5",null,[s(n,{t:"Are you sure to restore this backup?"})]),e("div",rt,[e("button",{disabled:l.value,onClick:a[2]||(a[2]=C=>x()),class:"btn btn-success rounded-3"},[s(n,{t:"Yes"})],8,ut),e("button",{onClick:a[3]||(a[3]=C=>o.value=!1),disabled:l.value,class:"btn bg-secondary-subtle text-secondary-emphasis border-secondary-subtle rounded-3"},[s(n,{t:"No"})],8,ct)])])])):N("",!0)]),_:1}),e("div",mt,[e("div",ft,[e("small",gt,[s(n,{t:"Backup"})]),e("samp",null,L(d.b.filename),1)]),e("div",bt,[e("small",vt,[s(n,{t:"Backup Date"})]),O(" "+L(T(ae)(d.b.backupDate,"YYYYMMDDHHmmss").format("YYYY-MM-DD HH:mm:ss")),1)]),e("div",pt,[e("button",{onClick:a[4]||(a[4]=C=>_()),class:"btn bg-primary-subtle text-primary-emphasis border-primary-subtle rounded-3 btn-sm"},a[8]||(a[8]=[e("i",{class:"bi bi-download"},null,-1)])),e("button",{onClick:a[5]||(a[5]=C=>o.value=!0),class:"btn bg-warning-subtle text-warning-emphasis border-warning-subtle rounded-3 btn-sm"},a[9]||(a[9]=[e("i",{class:"bi bi-clock-history"},null,-1)])),e("button",{onClick:a[6]||(a[6]=C=>f.value=!0),class:"btn bg-danger-subtle text-danger-emphasis border-danger-subtle rounded-3 btn-sm"},a[10]||(a[10]=[e("i",{class:"bi bi-trash-fill"},null,-1)]))])]),a[14]||(a[14]=e("hr",null,null,-1)),e("div",ht,[e("a",{role:"button",class:P(["card-header d-flex text-decoration-none align-items-center",{"border-bottom-0":!$.value}]),style:{cursor:"pointer"},onClick:a[7]||(a[7]=C=>$.value=!$.value)},[e("small",null,[a[11]||(a[11]=O(".conf ")),s(n,{t:"File"})]),a[12]||(a[12]=e("i",{class:"bi bi-chevron-down ms-auto"},null,-1))],2),$.value?(g(),h("div",yt,[e("textarea",{class:"form-control rounded-3",value:d.b.content,disabled:"",style:{height:"300px","font-family":"var(--bs-font-monospace),sans-serif !important"}},null,8,xt)])):N("",!0)]),a[15]||(a[15]=e("hr",null,null,-1)),e("div",_t,[e("span",null,[a[13]||(a[13]=e("i",{class:"bi bi-database me-1"},null,-1)),s(n,{t:"Database File"})]),e("i",{class:P(["bi ms-auto",[d.b.database?"text-success bi-check-circle-fill":"text-danger bi-x-circle-fill"]])},null,2)])])]))}},Ct=M(wt,[["__scopeId","data-v-9f0c0156"]]),kt={class:"peerSettingContainer w-100 h-100 position-absolute top-0 start-0 overflow-y-scroll",ref:"editConfigurationContainer"},$t={class:"d-flex h-100 w-100"},St={class:"modal-dialog-centered dashboardModal w-100 h-100 overflow-x-scroll flex-column gap-3 mx-3"},Nt={class:"my-5 d-flex gap-3 flex-column position-relative"},Pt={class:"title"},Bt={class:"d-flex mb-3"},Rt={class:"mb-0"},Dt={class:"position-relative d-flex flex-column gap-3"},Lt={class:"text-center title",key:"spinner"},Wt={class:"card my-0 rounded-3",key:"noBackups"},Vt={class:"card-body text-center text-muted"},Ot={__name:"configurationBackupRestore",emits:["close","refreshPeersList"],setup(d,{emit:r}){const t=F(),f=y([]),o=y(!0),b=r;U(()=>{u()});const u=()=>{o.value=!0,I("/api/getWireguardConfigurationBackup",{configurationName:t.params.id},l=>{f.value=l.data,o.value=!1})},p=()=>{I("/api/createWireguardConfigurationBackup",{configurationName:t.params.id},l=>{f.value=l.data,o.value=!1})};return(l,m)=>(g(),h("div",kt,[e("div",$t,[e("div",St,[e("div",Nt,[e("div",Pt,[e("div",Bt,[e("h4",Rt,[s(n,{t:"Backup & Restore"})]),e("button",{type:"button",class:"btn-close ms-auto",onClick:m[0]||(m[0]=x=>l.$emit("close"))})]),e("button",{onClick:m[1]||(m[1]=x=>p()),class:"btn bg-primary-subtle text-primary-emphasis border-primary-subtle rounded-3 w-100"},[m[4]||(m[4]=e("i",{class:"bi bi-plus-circle-fill me-2"},null,-1)),s(n,{t:"Create Backup"})])]),e("div",Dt,[s(Z,{name:"list1"},{default:z(()=>[o.value&&f.value.length===0?(g(),h("div",Lt,m[5]||(m[5]=[e("div",{class:"spinner-border"},null,-1)]))):!o.value&&f.value.length===0?(g(),h("div",Wt,[e("div",Vt,[m[6]||(m[6]=e("i",{class:"bi bi-x-circle-fill me-2"},null,-1)),s(n,{t:"No backup yet, click the button above to create backup."})])])):N("",!0),(g(!0),h(V,null,K(f.value,x=>(g(),B(Ct,{onRefresh:m[2]||(m[2]=_=>u()),onRefreshPeersList:m[3]||(m[3]=_=>b("refreshPeersList")),b:x,key:x.filename},null,8,["b"]))),128))]),_:1})])])])])],512))}},It=M(Ot,[["__scopeId","data-v-1f718118"]]),Mt={id:"editPeerSettingsOverride"},Ht={class:"mb-0"},Kt={class:"mb-3 text-muted"},Tt={class:"d-flex gap-2 flex-column"},zt={for:"override_dns",class:"form-label"},Ut={class:"text-muted"},Ft=["disabled"],At={for:"override_endpoint_allowed_ips",class:"form-label"},Et={class:"text-muted"},Jt=["disabled"],jt={for:"override_listen_port",class:"form-label"},Yt={class:"text-muted"},Gt=["disabled"],qt={for:"override_mtu",class:"form-label"},Zt={class:"text-muted"},Qt=["disabled"],Xt={for:"override_peer_remote_endpoint",class:"form-label"},es={class:"text-muted"},ts=["disabled"],ss={for:"override_persistent_keepalive",class:"form-label"},ns={class:"text-muted"},os=["disabled"],ls={class:"d-flex mt-1 gap-2"},is=le({__name:"editPeerSettingsOverride",props:["configuration"],setup(d){const r=d,t=y(!1),f=y({...r.configuration.Info.OverridePeerSettings}),o=y(!1);U(()=>{document.querySelectorAll("#editPeerSettingsOverride input").forEach(p=>p.addEventListener("change",()=>{o.value=!0}))});const b=()=>{f.value=r.configuration.Info.OverridePeerSettings,o.value=!1},u=async()=>{await D("/api/updateWireguardConfigurationInfo",{Name:r.configuration.Name,Key:"OverridePeerSettings",Value:f.value},p=>{p.status&&(r.configuration.Info.OverridePeerSettings=f.value)})};return(p,l)=>(g(),h("div",Mt,[e("h5",Ht,[s(n,{t:"Override Peer Settings"})]),e("h6",Kt,[e("small",null,[s(n,{t:"Only apply to peers in this configuration"})])]),e("div",Tt,[e("div",null,[e("label",zt,[e("small",Ut,[s(n,{t:"DNS"})])]),k(e("input",{type:"text",class:"form-control form-control-sm rounded-3",disabled:t.value,"onUpdate:modelValue":l[0]||(l[0]=m=>f.value.DNS=m),id:"override_dns"},null,8,Ft),[[S,f.value.DNS]])]),e("div",null,[e("label",At,[e("small",Et,[s(n,{t:"Endpoint Allowed IPs"})])]),k(e("input",{type:"text",class:"form-control form-control-sm rounded-3",disabled:t.value,"onUpdate:modelValue":l[1]||(l[1]=m=>f.value.EndpointAllowedIPs=m),id:"override_endpoint_allowed_ips"},null,8,Jt),[[S,f.value.EndpointAllowedIPs]])]),e("div",null,[e("label",jt,[e("small",Yt,[s(n,{t:"Listen Port"})])]),k(e("input",{type:"text",class:"form-control form-control-sm rounded-3",disabled:t.value,"onUpdate:modelValue":l[2]||(l[2]=m=>f.value.ListenPort=m),id:"override_listen_port"},null,8,Gt),[[S,f.value.ListenPort]])]),e("div",null,[e("label",qt,[e("small",Zt,[s(n,{t:"MTU"})])]),k(e("input",{type:"text",class:"form-control form-control-sm rounded-3",disabled:t.value,"onUpdate:modelValue":l[3]||(l[3]=m=>f.value.MTU=m),id:"override_mtu"},null,8,Qt),[[S,f.value.MTU]])]),e("div",null,[e("label",Xt,[e("small",es,[s(n,{t:"Peer Remote Endpoint"})])]),k(e("input",{type:"text",class:"form-control form-control-sm rounded-3",disabled:t.value,"onUpdate:modelValue":l[4]||(l[4]=m=>f.value.PeerRemoteEndpoint=m),id:"override_peer_remote_endpoint"},null,8,ts),[[S,f.value.PeerRemoteEndpoint]])]),e("div",null,[e("label",ss,[e("small",ns,[s(n,{t:"Persistent Keepalive"})])]),k(e("input",{type:"text",class:"form-control form-control-sm rounded-3",disabled:t.value,"onUpdate:modelValue":l[5]||(l[5]=m=>f.value.PersistentKeepalive=m),id:"override_persistent_keepalive"},null,8,os),[[S,f.value.PersistentKeepalive]])]),e("div",ls,[e("button",{class:P([{disabled:!o.value},"btn btn-sm bg-secondary-subtle border-secondary-subtle text-secondary-emphasis rounded-3 shadow ms-auto"]),onClick:l[6]||(l[6]=m=>b())},[l[8]||(l[8]=e("i",{class:"bi bi-arrow-clockwise me-2"},null,-1)),s(n,{t:"Reset"})],2),e("button",{class:P([{disabled:!o.value},"btn btn-sm bg-primary-subtle border-primary-subtle text-primary-emphasis rounded-3 shadow"]),onClick:l[7]||(l[7]=m=>u())},[l[9]||(l[9]=e("i",{class:"bi bi-save-fill me-2"},null,-1)),s(n,{t:"Save"})],2)])])]))}}),as={class:"peerSettingContainer w-100 h-100 position-absolute top-0 start-0",ref:"editConfigurationContainer"},ds={class:"w-100 h-100 overflow-y-scroll"},rs={class:"container d-flex h-100 w-100"},us={class:"m-auto modal-dialog-centered dashboardModal",style:{width:"700px"}},cs={class:"card rounded-3 shadow flex-grow-1"},ms={class:"card-header bg-transparent d-flex align-items-center gap-2 border-0 p-4"},fs={class:"mb-0"},gs={class:"card-body px-4 pb-4"},bs={class:"d-flex gap-2 flex-column"},vs={key:0,class:"d-flex align-items-center gap-3"},ps={class:"text-muted"},hs={class:"d-flex align-items-center gap-3"},ys={class:"text-muted",style:{"word-break":"keep-all"}},xs={class:"ms-auto",style:{"word-break":"break-all"}},_s={class:"d-flex"},ws={for:"configuration_private_key",class:"form-label"},Cs={class:"text-muted d-block"},ks={class:"form-check form-switch ms-auto"},$s=["disabled"],Ss={for:"configuration_ipaddress_cidr",class:"form-label"},Ns={class:"text-muted"},Ps=["disabled"],Bs={for:"configuration_listen_port",class:"form-label"},Rs={class:"text-muted"},Ds=["disabled"],Ls={class:"accordion mt-2",id:"editConfigurationOptionalAccordion"},Ws={class:"accordion-item"},Vs={class:"accordion-header"},Os={class:"accordion-button collapsed px-3 py-2",type:"button","data-bs-toggle":"collapse","data-bs-target":"#editOptionalAccordionCollapse"},Is={class:"text-muted"},Ms={id:"editOptionalAccordionCollapse",class:"accordion-collapse collapse","data-bs-parent":"#editConfigurationOptionalAccordion"},Hs={class:"accordion-body d-flex flex-column gap-3"},Ks=["for"],Ts={class:"text-muted"},zs=["disabled","onUpdate:modelValue","id"],Us=["for"],Fs={class:"text-muted"},As=["disabled","onUpdate:modelValue","id"],Es={class:"d-flex align-items-center gap-2 mt-1"},Js=["disabled"],js=["disabled"],Ys={class:"mb-3"},Gs={class:"d-flex gap-2 flex-column"},Xs={__name:"editConfiguration",props:{configurationInfo:Object},emits:["changed","close","refresh"],setup(d,{emit:r}){const t=d,f=Y(),o=H(),b=y(!1),u=J(JSON.parse(JSON.stringify(t.configurationInfo))),p=y(!1),l=y(!1),m=J({PrivateKey:!0,IPAddress:!0,ListenPort:!0}),x=()=>{f.checkWGKeyLength(u.PrivateKey)?(m.PrivateKey=!0,u.PublicKey=window.wireguard.generatePublicKey(u.PrivateKey)):m.PrivateKey=!1},_=()=>{l.value=!1,Object.assign(u,JSON.parse(JSON.stringify(t.configurationInfo)))},w=r,$=()=>{b.value=!0,D("/api/updateWireguardConfiguration",u,W=>{b.value=!1,W.status?(o.newMessage("Server","Configuration saved","success"),l.value=!1,w("dataChanged",W.data)):o.newMessage("Server",W.message,"danger")})},c=y(!1);G(u,()=>{l.value=JSON.stringify(u)!==JSON.stringify(t.configurationInfo)},{deep:!0});const a=y(!1),C=y(!1),A=y(!1);return(W,i)=>(g(),h("div",as,[e("div",ds,[s(Z,{name:"zoom"},{default:z(()=>[a.value?(g(),B(Ke,{key:0,name:"EditRawConfigurationFile",onClose:i[0]||(i[0]=v=>a.value=!1)})):N("",!0),A.value?(g(),B(Xe,{key:"DeleteConfiguration",onBackup:i[1]||(i[1]=v=>C.value=!0),onClose:i[2]||(i[2]=v=>A.value=!1)})):N("",!0),C.value?(g(),B(It,{key:2,onClose:i[3]||(i[3]=v=>C.value=!1),onRefreshPeersList:i[4]||(i[4]=v=>w("refresh"))})):N("",!0)]),_:1}),e("div",rs,[e("div",us,[e("div",cs,[e("div",ms,[e("h4",fs,[s(n,{t:"Configuration Settings"})]),e("button",{type:"button",class:"btn-close ms-auto",onClick:i[5]||(i[5]=v=>W.$emit("close"))})]),e("div",gs,[e("div",bs,[c.value?N("",!0):(g(),h("div",vs,[e("small",ps,[s(n,{t:"Name"})]),e("small",null,L(u.Name),1),e("button",{onClick:i[6]||(i[6]=v=>c.value=!0),class:"btn btn-sm bg-danger-subtle border-danger-subtle text-danger-emphasis rounded-3 ms-auto"},[s(n,{t:"Update Name"})])])),c.value?(g(),B(ve,{key:1,onClose:i[7]||(i[7]=v=>c.value=!1),"configuration-name":u.Name},null,8,["configuration-name"])):(g(),h(V,{key:2},[i[24]||(i[24]=e("hr",null,null,-1)),e("div",hs,[e("small",ys,[s(n,{t:"Public Key"})]),e("small",xs,L(u.PublicKey),1)]),i[25]||(i[25]=e("hr",null,null,-1)),e("div",null,[e("div",_s,[e("label",ws,[e("small",Cs,[s(n,{t:"Private Key"})])]),e("div",ks,[k(e("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"editPrivateKeySwitch","onUpdate:modelValue":i[8]||(i[8]=v=>p.value=v)},null,512),[[ie,p.value]]),i[18]||(i[18]=e("label",{class:"form-check-label",for:"editPrivateKeySwitch"},[e("small",null,"Edit")],-1))])]),k(e("input",{type:"text",class:P(["form-control form-control-sm rounded-3",{"is-invalid":!m.PrivateKey}]),disabled:b.value||!p.value,onKeyup:i[9]||(i[9]=v=>x()),"onUpdate:modelValue":i[10]||(i[10]=v=>u.PrivateKey=v),id:"configuration_private_key"},null,42,$s),[[S,u.PrivateKey]])]),e("div",null,[e("label",Ss,[e("small",Ns,[s(n,{t:"IP Address/CIDR"})])]),k(e("input",{type:"text",class:"form-control form-control-sm rounded-3",disabled:b.value,"onUpdate:modelValue":i[11]||(i[11]=v=>u.Address=v),id:"configuration_ipaddress_cidr"},null,8,Ps),[[S,u.Address]])]),e("div",null,[e("label",Bs,[e("small",Rs,[s(n,{t:"Listen Port"})])]),k(e("input",{type:"number",class:"form-control form-control-sm rounded-3",disabled:b.value,"onUpdate:modelValue":i[12]||(i[12]=v=>u.ListenPort=v),id:"configuration_listen_port"},null,8,Ds),[[S,u.ListenPort]])]),e("div",Ls,[e("div",Ws,[e("h2",Vs,[e("button",Os,[e("small",Is,[s(n,{t:"Optional Settings"})])])]),e("div",Ms,[e("div",Hs,[(g(),h(V,null,K(["Table","PreUp","PreDown","PostUp","PostDown"],v=>e("div",null,[e("label",{for:"configuration_"+v,class:"form-label"},[e("small",Ts,[s(n,{t:v},null,8,["t"])])],8,Ks),k(e("input",{type:"text",class:"form-control form-control-sm rounded-3",disabled:b.value,"onUpdate:modelValue":E=>u[v]=E,id:"configuration_"+v},null,8,zs),[[S,u[v]]])])),64)),d.configurationInfo.Protocol==="awg"?(g(),h(V,{key:0},K(["Jc","Jmin","Jmax","S1","S2","H1","H2","H3","H4"],v=>e("div",null,[e("label",{for:"configuration_"+v,class:"form-label"},[e("small",Fs,[s(n,{t:v},null,8,["t"])])],8,Us),k(e("input",{type:"number",class:"form-control form-control-sm rounded-3",disabled:b.value,"onUpdate:modelValue":E=>u[v]=E,id:"configuration_"+v},null,8,As),[[S,u[v]]])])),64)):N("",!0)])])])]),e("div",Es,[e("button",{class:"btn btn-sm bg-secondary-subtle border-secondary-subtle text-secondary-emphasis rounded-3 shadow ms-auto",onClick:i[13]||(i[13]=v=>_()),disabled:!l.value||b.value},[i[19]||(i[19]=e("i",{class:"bi bi-arrow-clockwise me-2"},null,-1)),s(n,{t:"Reset"})],8,Js),e("button",{class:"btn btn-sm bg-primary-subtle border-primary-subtle text-primary-emphasis rounded-3 shadow",disabled:!l.value||b.value,onClick:i[14]||(i[14]=v=>$())},[i[20]||(i[20]=e("i",{class:"bi bi-save-fill me-2"},null,-1)),s(n,{t:"Save"})],8,js)]),i[26]||(i[26]=e("hr",null,null,-1)),s(is,{configuration:d.configurationInfo},null,8,["configuration"]),i[27]||(i[27]=e("hr",null,null,-1)),e("h5",Ys,[s(n,{t:"Danger Zone"})]),e("div",Gs,[e("button",{onClick:i[15]||(i[15]=v=>C.value=!0),class:"btn bg-warning-subtle border-warning-subtle text-warning-emphasis rounded-3 text-start d-flex"},[i[21]||(i[21]=e("i",{class:"bi bi-copy me-auto"},null,-1)),s(n,{t:"Backup & Restore"})]),e("button",{onClick:i[16]||(i[16]=v=>a.value=!0),class:"btn bg-warning-subtle border-warning-subtle text-warning-emphasis rounded-3 d-flex"},[i[22]||(i[22]=e("i",{class:"bi bi-pen me-auto"},null,-1)),s(n,{t:"Edit Raw Configuration File"})]),e("button",{onClick:i[17]||(i[17]=v=>A.value=!0),class:"btn bg-danger-subtle border-danger-subtle text-danger-emphasis rounded-3 d-flex mt-4"},[i[23]||(i[23]=e("i",{class:"bi bi-trash-fill me-auto"},null,-1)),s(n,{t:"Delete Configuration"})])])],64))])])])])])])],512))}};export{Xs as default};
